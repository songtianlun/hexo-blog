---
title: 《GIS原理与技术》平时作业
url: 299.html
id: 299
categories:
  - 学习小记
date: 2018-11-26 02:55:36
tags:
---

《**GIS****原理与技术》平时作业** 专业： 空间信息与数字技术  班级： 1601  学号： 201616060110 姓名： 宋天伦

*   **问题：**

1.  什么是COM组件？需满足哪些条件？
2.  简述矢量数据模型的基本思想。试分析ESRI公司三种矢量数据产品的数据结构。
3.  几何变换如何定义、分类？简述仿射变换的实现过程。
4.  简述DEM、TIN的模型结构，比较二者的优缺点。
5.  简述常见的空间插值方法。
6.  简述最小耗费路径分析、最短路径分析的基本原理，二者有何异同？阐述其实现过程。

*   **评分标准** **&** **得分统计：**

**分值** **观测点**

**90-100****分**

**70-89****分**

**60-69****分**

**0-59****分**

**得分**

作业完成程度 （权重10%）

按时全部完成

延时全部完成

按时部分完成

延时部分完成

 

基本概念的理解 （权重30%）

概念清晰，知识全面

主要概念清晰，知识较全面

部分概念清晰，知识不全面

基本概念不清，知识缺失严重

 

基本原理（思想）的理解与掌握 （权重30%）

理解准确，知识全面，思路清晰

理解部分有误，知识较全面，思路基本清晰

理解有明显错误，知识不全面，思路不清晰

理解错误较多，知识缺失严重，思路混乱

 

基本方法的掌握 （权重30%）

方法理解透彻,运用熟练

方法理解较透彻，运用基本熟练

方法理解有明显错误，运用生疏

方法理解错误严重，未能掌握

 

总分

 

  **注意：**

1.  请修改班级、姓名、学号三部分内容，封面中其它内容（含格式）请勿修改；
2.  平时作业占总评成绩的30%；
3.  解答部分请勿删除题目内容；
4.  提交内容包括本文档的纸质版和电子版，二者内容和格式要求一致。

*   **解答：**

1.  什么是COM组件？需满足哪些条件？

答：（1）COM是Component Object Model （组件对象模型）的缩写；COM是一个规范，是一个说明如何建立可动态交替更新的组件的规范；COM提供了为保证能够互操作，客户和组件应遵循的标准。所谓规范我的理解是当一件事物要达到全球通用效果时必然的产物，要想生产一个零件拿到全国各地都可以使用，那就必须要系统和组件都遵循一定的标准，在这里这个标准可以理解为就是这个COM规范，而COM规范就是一套为组建架构设置标准的文档。 作为COM组件则是COM规范的一些具体实现，COM组件时以Win32动态链接库（DLL）或可执行文件（EXE）的形式发布的可执行代码组成的。我理解的COM组件更多的是一种思想和体系的体现，COM组件符合COM规范，类似于理论研究和应用研究之间的关系，作为理论研究可以为应用、方法的研究指明发展的方向，而作为应用、发展研究又能验证理论的可行性及完善性，二者互为补充。 COM组件实现的过程中有一个特点，那就是COM组件之间的联系是通过动态链接的方式连接的。COM组件使用DLL动态链接库将组件动态连接起来，从而实现COM的封装性、灵活性。COM组件的优势之一就是其能够很好的提供软件更新迭代，一个组件出问题不需一发而牵动全身，只需要修改相应的组件，再将组件更新到软件相应的位置中，程序就可以实现功能的完善和更新，而不需要修改整个程序，而动态链接的方式可以保证程序的健壮性及可移植性。另外一个特点就是COM组件本身的封装性，二者互为补充互相实现，不可分割。 而在这里还要特别的说明，COM组件绝不是一种计算机语言！COM组件不可以和某一种计算机语言相提并论，COM组件是一种思想，是一种体系，是一种该规范，COM组件是使用程序语言实现后体现的，不同的语言实现起来COM组件有不同的内涵，可以有不同的实现方式，而其内部深度的思想都是类似的，相似的。 COM组件如果仅仅是一些规范，没有具体实现的话，还是会令人感觉非常空洞，即使是能够写一个代码全球通用也很难持续下去这种热情，也就因此COM提供一个被叫做COM库的API，提供对于任何用户都非常有用的组件管理服务，一方面COM库可以提供最基本的功能，一方面COM库还可以提高软件开发的效率，可以使得用户快速的构建一些内容，提升开发速度，避免重复的写相同功能的代码，提升代码复用率，使得用户将精力更多的放在编写核心代码上，可以提升代码开发发展的进程，每个人可以各司其职开发出真正有用的程序代码，同时可以有更广泛的应用。 （2）COM为了实现动态插入或卸载出程序的这种功能，其本身需要符合一定条件：第一，组件必须是动态连接的；第二，它们必须隐蔽（或封装）其内部实现细节。这两者的关系同等重要，不需要比较，就像前面说的那样，二者互相依赖，互相实现，互相促进，不可分割。 对于动态链接来说：动态链接是指组件之间相互的链接必须是动态的，可热插拔的，用户运行的过程中可以将组件替换掉的。即使不是所有的用户程序中都提供这样的自由替换组件的功能，但是拥有这种替换方式的系统相较于其他系统有着不可比拟的优势，仔细想一下如果想要运行过程中实现热插拔，那就一定要实现动态链接。 动态链接对于一个健壮的软件系统来讲是非常重要的。如果软件系统中的所有代码段都是不能独立存在替换的，那如果要实现系统部分功能更新，就必然的需要将其他的所有（包括无变化代码段）代码都进行重新编译、链接来实现。这种方式是非常耗费时间非常得不偿失的，而且在隐约间还增加了用户和软件提供商双方的压力，用户如果没有一些软件只是就很难对出问题的软件系统进行修改，必须依赖软件工程师，而软件工程师需要解决的问题常常是一个非常小的部分，这样牵一发而动全身，非常的耗时耗力，时间被用来做重复性工作，带来了非常大的人力资源浪费，在实际使用过程中这样的资源耗费是实际企业所不能接受的。也就因此，动态链接对于一个健壮的系统来说有着非常重要的作用。 对于封装性来说。封装性是实现动态链接的基础，如果一个软件不是封装好的，是零散的不成体系，组件之间功能分区不具体的，那就必然会带来一系列的问题。动态链接也就失去了其自身的价值。作为普通用户来说，如果一个系统提供给了动态链接功能，可以替换掉特定的组件，而此时组件不是一个完整的，内部细节是可见的，就常常使得用户将精力放在了这些完全不需要了解的部分上。用户更关心的是自己需要什么功能，以及这些组件可以用来做什么，而完全不需要知道组件内部是如何提供功能的。因此一个界限清晰、封装良好，内部不可见的封装性对于软件的组件式开发来说非常重要。 可以说，封装性和动态链接性是相互依存相互促进的，组件的封装性很强，组件之间的界限清晰明了，在进行动态链接时就更方便，更便捷，更高效。同样的如果系统共提供的动态链接性能很高，系统封装良好的组件就能更好的协同工作，同时用户使用的过程中可以更好的进行系统的链接、组件的热插拔等工作。二者共同促进，相互依存，可以更好的帮助软件提供者为用户提供更高效的软件体验，二者共同作用可以发挥出COM组件式开发不可估量的潜力及优势。

2.  简述矢量数据模型的基本思想。试分析ESRI公司三种矢量数据产品的数据结构。

答：（1）矢量数据模型的基本思想：矢量数据模型也叫做离散对象模型，是采用离散对象来表示地球表面的空间要素的。矢量数据模型用点、线和面等几何对象来表示简单的空间要素。现实世界中的真实地物分为很多种，如何将地理世界中的物体尽量真实的反应在计算机中，使用计算机能识别的方式进行存储，这是科学家们一直在思考的一个问题。而矢量数据模型是众多的数据模型的一种，以精度和小体量著称。矢量数据模型将地理空间实体看作是一个空域，在此基础上将真实地物抽象为点、线、面以及体等内容，再赋予相应的属性数据，转换为计算机可以存储的数据格式，在计算机中进行存储。 矢量数据将现实世界中的各种地物抽象成为一个个的离散个体，分别对每一个事物的形态特征将其抽象为点、线、面或是体，数据均是以离散的方式存储在计算机中。比如说点的存储在计算机中是一系列的坐标对和属性表的集合，离散的方式存储；而对于线则是一个个点连接在一起的集合构成线条，同样是离散化，读于面则是线和点的集合构成一个个的面对象。由此，地理空间实体中的各种数据均被数字化，使用数字化的形式存储在计算机中，意味着矢量数据的显示将有着得天独厚的天然条件，那就是高精度，即使是放大到再大的范围也不会使得地图失真，对于地理空间实体的描述会非常准确。 矢量数据的生产过程常常是可以有如下三个步骤的：第一步，在一个空的空间将地理空间要素分为点、线、和多边形，并用点及其x、y坐标表示这些要素的位置和形状。第二步，以一个逻辑架构构建这个几何对象的属性和空间关系。第三步，编码并将矢量数据以数字数据文件存储，这样它们可以被访问、解释，并由计算机进行处理。 而在实际的矢量数据生产过程中，矢量数据的来源常常有以下几种：卫星图描绘、地图矢量化、实际测绘。使用卫星图描绘的方式生产的矢量数据，其精度和卫星图的精度息息相关，若是卫星图的分辨率较高，生产出的矢量数据精度也可以达到一个比较高的水平，而如果卫星图的分辨率较低，则很难达到一个比较高的水平。不过使用卫星图进行描绘相较于实际测量其精度会更高，因为其本身就是基于一个特定的坐标系，在其基础上进行标绘不需要进行再一步的配准等操作，减少了误差。作为现有地图矢量化的方式生产的数据常常要经过第一步的配准，配准过程中常常会产生很多不必要的误差，也就因此使用现有栅格地图矢量化的形式常常精度难以保证。而实际测量是最精确的一种方式，同时其生产的矢量数据会更加的精确，有着更加详细的数据反应程度，其数据可行度很有保障，但同时其弊端也是不言而喻，那就是需要大量的人力物力去实力测量，会耗费大量的精力去做，因此这种方式在当代逐渐被其他更搞笑的方式替换。 （2）ESRI公司三种矢量数据产品的数据结构 1）Coverage文件 Coverage 是ArcInfo workstation 的原生数据格式。之所以称之为“基于文件夹的存储”， 是因为在 windows资源管理器下，它的空间信息和属性信息是分别存放在两个文件夹里。例如，在我的电脑 E:\\MyTest\\example 文件夹中，有 3 个coverage，它们在 windows 资源管理器下的状态所有信息都以文件夹的形式来存储。空间信息以二进制文件的形式存储在独立的文件夹中，文件夹名称即为该 coverage 名称，属性信息和拓扑数据则以 INFO表的形式存储。Coverage将空间信息与属性信息结合起来，并存储要素间的拓扑关系。 然而，通过 ArcCatalog，我们能将存储空间信息的文件夹中的 coverage二进制文件与存储属性信息的 INFO 文件夹中的 INFO表联合表达为 coverage，当使用 ArcCatalog 对 coverage 进行创建、移动、删除或重命名等操作时，ArcCatalog 将自动维护他们的完整性，将 coverage和 INFO文件夹中的内容同步改变。所以对 coverage进行操作，一定要在 ArcCatalog 中进行。 coverage 是一个非常成功的早期地理数据模型，二十多年来深受用户欢迎，很多早期的数据都是 coverage 格式的。ESRI 不公开 coverage 的数据格式，但是提供了 coverage 格式转换的一个交换文件（interchange file，即 E00），并公开数据格式，这样就方便了 coverage 数据与其他格式的数据之间的转换。 Coverage 是一个集合，它可以包含一个或多个要素类。 2）Shapefile 一个ESRI的shapefile数据包含一个主文件（.shp），一个索引文件（.shx）和一个dBASE（.dbf）表。主文件是直接访问的，变长记录的文件，每一条记录都描述一个形状的一系列结点。在索引文件中，每一条记录包含主文件相应记录相对于主文件头的偏移量。dBASE表中每条记录表示一个要素的属性。这种几何结构和属性要素一对一的关系是通过记录号来控制的，表中的属性记录的顺序必须和主文件中的记录顺序相同。 一、主文件： 主文件（.shp）包含一个定长的文件头，之后就是变长的记录。每一条变长的记录都是由一个定长的记录头和变长的记录内容组成的。Shapefile的内容分为两类：一是数据相关，包括主文件记录内容和主文件头的数据描述范围（形状类型，最小矩形外框等）；二是文件管理相关，包括文件和记录的长度和记录的偏移量等。主文件中用于记录数据相关的整型和双精度整型的字节序是little endian（PC或Intel），而用于文件管理相关的字节序则是big endian（Sun or Motorola）。 主文件头长度为100字节。下表列出头的字节位置、值、类型和字节序。

位置

字段

字段值

字段类型

字节序

Byte 0

文件代码

9994

整型

Big

4

未使用

0

整型

Big

20

未使用

0

整型

Big

24

文件长度

文件长度

整型

Big

28

版本

1000

整型

Little

32

几何形状

形状类型

整型

Little

36

边界框

X最小值

双精度浮点型

Little

44

边界框

Y最小值

双精度浮点型

Little

52

边界框

X最大值

双精度浮点型

Little

60

边界框

Y最大值

双精度浮点型

Little

68*

边界框

Z最小值

双精度浮点型

Little

76*

边界框

Z最大值

双精度浮点型

Little

84*

边界框

M最小值

双精度浮点型

Little

92*

边界框

M最小值

双精度浮点型

Little

注意：如果不是测量或者Z型，带*的部分就没有使用，其值为0.0。 文件长度是文件的所有长度，用16位字表示（即包括50个16位字长度的文件头）。 几何类型的对应值为：无形状（0），点（1），线（3），多边形（5），多点（8），Z型点（11），Z型线（13），Z型多边形（15），Z型多点（18），M型点（21），M型线（23），M型多边形（25），M型多点（28），MultiPatch（31）。 每一条记录的头保存该条记录号和内容长度。记录头是定长的，占8字节。前4字节整型表示记录号，字节序是Big；后4字节整型表示记录内容长度，字节序是Big。内容长度只是内容的长度，用16位字表示。所以，每条记录的长度就是（4＋内容长度）的16位字表示。 主文件的记录内容包含几何类型和几何数据。记录内容的长度取决于形状的部分和结点的数量，每一种几何类型有其相应的记录内容。 （１）无形状：通常无形状是用来占位的，在shapefile创建时设置为无形状，之后再 添加几何数据。

位置

字段

字段值

字段类型

个数

字节序

Byte 0

几何形状

0

整型

1

Little

（２）X，Y空间的点：包括一对双精度的X，Y坐标值。

位置

字段

字段值

字段类型

个数

字节序

0

几何形状

1

整型

1

Little

4

X

X坐标

双精度

1

Little

12

Y

Y坐标

双精度

1

Little

（３）X，Y空间的多点：是一个点集。包括边界框、点个数和各个点的坐标。

位置

字段

字段值

字段类型

个数

字节序

0

几何形状

8

整型

1

Little

4

边界框

矩形顶点值

双精度

4

Little

36

点数

点的个数值

整型

1

Little

40

点集

各个点坐标

点型

点的个数

Little

（４）X，Y空间的线：是一个有序的顶点集合，包括一个或多个部分。部分是指连接两个或两个以上顶点的序列。部分可能会相连也可能不相连，可能相交也可能不相交。包括边界框、部分数、点数、每个部分第一个点的索引序号和各个点的坐标。 注意：X＝44＋4×部分的个数。

位置

字段

字段值

字段类型

个数

字节序

0

几何形状

3

整型

1

Little

4

边界框

矩形顶点值

双精度

4

Little

36

部分数

部分个数值

整型

1

Little

40

点数

点的个数值

整型

1

Little

44

部分集

每个部分第一个点在点集中的序号

整型

部分的个数

Little

X

点集

各个点坐标

点型

点的个数

Little

（５）X，Y空间的多边形：一个多边形包含一个或多个环。环是一个首尾连接的由4个或4个以上的点组成的一个封闭的，非自交的环路。一个多边形可能包含多重外环路。一个环的顶点顺序或方向显示了环是否位于多边形的内部。内部环是逆时针的，而简单的环状多边形通常是顺时针的。和线类似，多边形也包括边界框、部分数、点数、每个部分第一个点的索引序号和各个点的坐标，只是多边形中把环看做是部分。其内容表同线相同，略。 3）Geodatebase Geodatabase是面向对象的空间数据存储模型，将地理数据存储在普通的文件File Geodatabase中、Personal database（微软的Access数据库的.mdb文件）中或者多用户的关系数据库Enterprise Geodatabase（比如Oracle, Microsoft SQL Server, 或者IBM DB2）。 **总结** 三种数据类型各有特点，其区别界限也比较明显：coverage和shapefile的区别就在于converg是一种包含拓扑关系的数据存储类型，而shapefile是一种非拓扑类型的数据。包含拓扑关系可以加快数据分析速度、更快的构建空间索引、更快的空间查询，有多种优点，而非拓扑的数据有这很强的互操作性和处理速度，得益于二者各自的特色，两种文件形式在当今都非常受欢迎。而geodatebase文件融入了面向对象的思维，除了封装了数据之外还将还将对数据的操作一并封装，具有对特定数据操作的功能，具有面向对象思维的全部优点。

3.  几何变换如何定义、分类？简述仿射变换的实现过程。

答：（1）几何变换是利用一系列控制点和转换方程式在投影坐标上配准数字化地图、卫星图象或航空相片的过程。如同此定义所述，几何变换是GIS、遥感和摄影测量学里共同的一种操作。（2）分类：根据几何变换输入端和输入端的不同可将几何变换分为地图到地图和图象到地图的变换。刚数字化完毕的地图，无论是经手工数字化还是扫描文件跟踪，其单元都是基于数字化仪单位。而数字化仪的单位可能是英寸或是点/英寸。这种刚数字化完毕的地图转换到投影坐标的几何变换过程，通常称之为**地图到地图的变换**。而影像到地图的变换适用于遥感数据。这个术语表明这种变换把卫星影像的行和列转换为投影坐标。无论是这两种中的哪一种，都是需要在数据上找到一定数量合适的控制点，通过控制点建立输入端到输出端的空间对应关系，也就是由于控制点的不稳定性，常常导致转换效果的差别。而衡量转换结果也有专门的标准，那就是通过均方根误差的方式来衡量几何变换质量。 （3）仿射变换的实现过程 数字化地图或卫星影像的仿射变换都包括三个步骤：第一步，将所选控制点的x、y坐标更新为真实世界坐标。如果不能更新为真是世界坐标，可通过投影控制点的经纬度获得；第二步，在控制点上运行仿射变换，并检验RMS误差，如果RMS误差在可接受范围之内，那么从控制点估算得出的6个仿射变换系数将会应用于下一步中；第三步，用估算系数和变换方程计算数字化地图的要素或影像像元的x、y坐标。最后一步输出的结果将是一幅全新的基于自定义投影坐标系的地图或是图象。

4.  简述DEM、TIN的模型结构，比较二者的优缺点。

答：（1）数字高程模型（Digital Elevation Model)，简称DEM，是通过有限的地形高程数据实现对地面地形的数字化模拟（即地形表面形态的数字化表达），它是用一组有序数值阵列形式表示地面高程的一种实体地面模型，是数字地形模型(Digital Terrain Model，简称DTM)的一个分支，其它各种地形特征值均可由此派生。（2）TIN，又叫做不规则格网的DEM，是基于矢量的数字地理数据的一种形式，通过将一系列折点组成的三角形来构建。各折点通过由一系列边进行连接，最终形成一个三角网。 （3）DEM的优点：规则格网的高程矩阵，可以很容易地用计算机进行处理，特别是栅格数据结构的地理信息系统。它还可以很容易地计算等高线、坡度坡向、山坡阴影和自动提取流域地形，使得它成为DEM 最广泛使用的格式，目前许多国家提供的 DEM数据都是以规则格网的数据矩阵形式提供的。 DEM缺点：1）在地形平坦的地方，存在大量的数据冗余；2）在不改变格网大小的情况下，难以表达复杂地形的突变现象；3）在某些计算，如通视问题，过分强调网格的轴方向。 TIN优点：不规则三角网数字高程由连续的三角面组成，三角面的形状和大小取决于不规则分布的测点，或节点的位置和密度。不规则三角网与高程矩阵方法不同之处是随地形起伏变化的复杂性而改变采样点的密度和决定采样点的位置，因而它能够避免地形平坦时的数据冗余，又能按地形特征点如山脊、山谷线、地形变化线等表示数字高程特征。 TIN缺点：算法实现比较复杂和困难，计算量大，地图渲染速度较慢。

5.  简述常见的空间插值方法。

答：空间插值方法可以分为整体插值和局部插值方法两类。整体插值方法用研究区所有采样点的数据进行全区特征拟合；局部插值方法是仅仅用临近的数据点来估计未知点的值。整体插值方法通常不直接用于空间插值，而是用来检测不同于总趋势的最大偏离部分，在去除了宏观地物特征后，可用剩余残差来进行局部插值。由于总体插值方法将短尺度的、局部的变化看作随机的和非结构的噪声，从而丢失了这一部分信息。局部插值方法恰好能弥补整体插值方法的缺陷，可用于局部异常值，而且不受插值表面上其他点的内插值影响。 （1）整体插值法有边界内插法、趋势面分析、变换函数插值。整体插值方法通常使用方差分析和回归方程等标准的统计方法，计算比较简单。其他的许多方法也可用于整体空间插值，如傅里叶级数和小波变换，特别是遥感影像分析方面，但它们需要的数据量大。 （2）局部插值方法只使用临近的数据点来估计未知点的值，需要注意的几个方面是：所使用的插值函数，领域大大小、形状和方向，数据点的个数，数据点的分布行驶是规则的还是不规则的。有最临近点法——泰森多边形方法、移动平均插值方法——距离倒数插值、样条函数插值方法、空间自协方差最佳插值方法——克里金插值。 分类总结： （1）根据使用样本点的数量可将空间插值分为全局和局部拟合法。全局插值法利用现有的每个已知点来估算未知点的值。而局部插值法则是用已知点的样本来估算未知点的值。 （2）根据插值面是否通过所有控制点可将插值方法分为精确的和非精确的插值法。对某个数值已知的点，精确插值法在该店位置的估算值与该点已知值相同。而非精确插值估算的点值可能与已知点不同。 （3）根据是否提供误差检验可将插值方法分为确定性和随机性两种。确定性插值方法不提供预测值，而随机性插值方法考虑变量的随机性和用估计变异提供预测误差的评价。

6.  简述最小耗费路径分析、最短路径分析的基本原理，二者有何异同？阐述其实现过程。

答：（1）最小耗费路径分析所需要包括源栅格、耗费栅格、耗费距离量差和生成最小累计耗费路径的算法。简单来说，最小耗费距离分析是以源栅格为基础，以耗费栅格为耗费依照，从起点到终点逐个像元的计算起点/终点到每一个像元所需要耗费的值。 （2）最短路径分析则是在网络中寻找节点间累计阻抗最小的路径。 （3）分析异同：二者都是基于原始数据及阻抗数据计算路径中的起点到终点间的最小消耗；而二者又有着本质的区别：最小耗费路径分析是基于栅格数据进行的计算，也就是说所有计算都是基于栅格的连续性思想进行计算，计算非常简单，运行效率也比较快，极具规律性；而最短路径分析则是基于矢量的路网及其阻抗矩阵，通过一定的算法从众多的路径中找到耗费最短的那一条。这样的方式计算出的路线更直观，但同时也会增加很多计算量，算法的效率在这里显得尤为重要。同时如果路网太过复杂，进行最短路径分析的时间耗费会非常的久。 （4）实现过程：二者的实现过程在前面回答过程中都有稍微提到，在此基础上进行一个小的总结： 最小耗费路径分析：第一步，进行耗费距离量测，基于节点-链接像元的表示方法，计算每一个栅格链接像元耗费以及对角线链接耗费；第二步，生成最小累计耗费路径。基于Dijkstra算法进行迭代，激活与像元邻接的像元，计算出这些香院的耗费，累计执行，直到输出山各种所有像元被赋予他们的最小累计耗费；第三步，输出结果。根据所需要的结果可以输出最小耗费距离栅格、方向栅格、配置栅格、最短路径栅格。 最短路径分析：第一步，获得阻抗矩阵。第二步，基于Dijkstra算法找到两点之间耗费最小的一条通路。